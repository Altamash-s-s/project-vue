{"version":3,"sources":["webpack:///./components/Header/SearchBar/SearchBar.vue?285b","webpack:///./components/Header/SearchBar/SearchBar.vue?1fa4","webpack:///./components/Header/SearchBar/SearchBar.vue?37b4","webpack:///./components/directives/click-outside/click-outside-directive.ts","webpack:///./components/Header/SearchBar/SearchBar.vue?82cc","webpack:///./components/Header/SearchBar/SearchBar.vue?6e2a","webpack:///./components/Header/SearchBar/SearchBar.vue"],"names":["clickOutside","bind","el","binding","closeHandler","value","_outsideClickHandler","event","contains","target","stopPropagation","document","addEventListener","unbind","removeEventListener","defineComponent","name","components","SfSearchBar","SfButton","SvgImage","directives","props","isSearchOpen","type","Boolean","default","itemsPerPage","Number","minTermLen","emits","setup","emit","term","ref","route","useRoute","getProductList","useProduct","showSearch","body","classList","add","hideSearch","remove","toggleSearch","closeSearch","searchResultsEl","querySelector","closeTriggerElement","rawHandleSearch","searchTerm","length","productList","pageSize","search","items","debouncedHandleSearch","debounce","handleKeydownEnter","cancel","watch"],"mappings":"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","file":"109.js","sourcesContent":["// Exports\nmodule.exports = {\n\n};\n","export * from \"-!../../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-0!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-1!../../../node_modules/sass-loader/dist/cjs.js??ref--7-oneOf-1-2!../../../node_modules/sass-resources-loader/lib/loader.js??ref--7-oneOf-1-3!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../node_modules/unplugin/dist/webpack/loaders/transform.js??ref--15-0!./SearchBar.vue?vue&type=style&index=0&id=d3ca465c&prod&lang=scss&scoped=true&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('SfSearchBar',{directives:[{name:\"click-outside\",rawName:\"v-click-outside\",value:(_vm.closeSearch),expression:\"closeSearch\"}],staticClass:\"sf-header__search\",attrs:{\"placeholder\":_vm.$t('Search for items'),\"aria-label\":\"Search\",\"value\":_vm.term},on:{\"input\":function($event){return _vm.debouncedHandleSearch($event)},\"keyup\":function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"enter\",13,$event.key,\"Enter\")){ return null; }_vm.handleKeydownEnter($event.target.value) /* https://github.com/vuestorefront/storefront-ui/issues/2453#issuecomment-1160231619 */},\"keydown\":[function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"tab\",9,$event.key,\"Tab\")){ return null; }return _vm.hideSearch.apply(null, arguments)},function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"esc\",27,$event.key,[\"Esc\",\"Escape\"])){ return null; }return _vm.closeSearch.apply(null, arguments)}],\"focus\":_vm.showSearch,\"click\":_vm.showSearch},scopedSlots:_vm._u([{key:\"icon\",fn:function(){return [(!!_vm.term)?_c('SfButton',{staticClass:\"sf-search-bar__button sf-button--pure\",attrs:{\"aria-label\":\"Close search\"},on:{\"click\":_vm.closeSearch}},[_c('span',{staticClass:\"sf-search-bar__icon\"},[_c('SvgImage',{attrs:{\"icon\":\"cross\",\"label\":_vm.$t('Cancel'),\"width\":\"18\",\"height\":\"18\"}})],1)]):_c('SfButton',{staticClass:\"sf-search-bar__button sf-button--pure\",attrs:{\"aria-label\":\"Open search\"},on:{\"click\":_vm.toggleSearch,\"keydown\":function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"tab\",9,$event.key,\"Tab\")){ return null; }return _vm.hideSearch.apply(null, arguments)}}},[_c('span',{staticClass:\"sf-search-bar__icon\"},[_c('SvgImage',{attrs:{\"icon\":\"search\",\"label\":_vm.$t('Search'),\"width\":\"18\",\"height\":\"18\"}})],1)])]},proxy:true}])})}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","/* eslint-disable no-underscore-dangle */\n/* eslint-disable no-param-reassign */\n\nimport { DirectiveOptions } from 'vue';\n\ntype ElementWithClickOutsideListener = HTMLElement & { _outsideClickHandler: (e: MouseEvent) => void };\nexport const clickOutside : DirectiveOptions = {\n  bind(el: ElementWithClickOutsideListener, binding) {\n    const closeHandler = binding.value;\n\n    el._outsideClickHandler = (event: MouseEvent) => {\n      if (!el.contains(event.target as Node)) {\n        event.stopPropagation();\n        closeHandler(event, el);\n      }\n    };\n\n    document.addEventListener('mousedown', el._outsideClickHandler);\n    document.addEventListener('touchstart', el._outsideClickHandler);\n  },\n  unbind(el: ElementWithClickOutsideListener) {\n    document.removeEventListener('mousedown', el._outsideClickHandler);\n    document.removeEventListener('touchstart', el._outsideClickHandler);\n    el._outsideClickHandler = null;\n  },\n};\n","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { SfButton, SfSearchBar } from '@storefront-ui/vue';\nimport {\n  defineComponent, ref, watch, useRoute,\n} from '@nuxtjs/composition-api';\nimport { debounce } from 'lodash-es';\nimport { clickOutside } from '~/components/directives/click-outside/click-outside-directive';\nimport SvgImage from '~/components/General/SvgImage.vue';\nimport { useProduct } from '~/modules/catalog/product/composables/useProduct';\nimport { Products } from '~/modules/GraphQL/types';\n\nexport default defineComponent({\n  name: 'SearchBar',\n  components: {\n    SfSearchBar,\n    SfButton,\n    SvgImage,\n  },\n  directives: { clickOutside },\n  props: {\n    isSearchOpen: {\n      type: Boolean,\n      default: false,\n    },\n    itemsPerPage: {\n      type: Number,\n      default: 12,\n    },\n    minTermLen: {\n      type: Number,\n      default: 3,\n    },\n  },\n  emits: ['set-is-open', 'set-search-results'],\n  setup(props, { emit }) {\n    const term = ref('');\n    const route = useRoute();\n\n    const { getProductList } = useProduct();\n\n    const showSearch = () => {\n      if (!props.isSearchOpen) {\n        emit('set-is-open', true);\n        if (document) {\n          document.body.classList.add('no-scroll');\n        }\n      }\n    };\n\n    const hideSearch = () => {\n      if (props.isSearchOpen) {\n        emit('set-is-open', false);\n        emit('set-search-results', null);\n        if (document) {\n          document.body.classList.remove('no-scroll');\n        }\n      }\n    };\n\n    const toggleSearch = () => {\n      if (props.isSearchOpen) {\n        hideSearch();\n      } else {\n        showSearch();\n      }\n    };\n\n    const closeSearch = (event: MouseEvent) => {\n      if (document) {\n        const searchResultsEl = document.querySelector('.search');\n        const closeTriggerElement = event.target as HTMLElement;\n\n        if (!searchResultsEl?.contains(closeTriggerElement)) {\n          hideSearch();\n          term.value = '';\n        }\n      } else {\n        hideSearch();\n        term.value = '';\n      }\n    };\n\n    const rawHandleSearch = async (searchTerm: string) => {\n      term.value = searchTerm;\n      if (term.value.length < props.minTermLen) return;\n\n      // M2-579\n      const productList : Products = await getProductList({\n        pageSize: props.itemsPerPage,\n        search: term.value,\n      }) as unknown as Products;\n\n      emit('set-search-results', productList!.items);\n    };\n\n    const debouncedHandleSearch = debounce(rawHandleSearch, 1000);\n\n    const handleKeydownEnter = (searchTerm: string) => {\n      // cancel debounce timeout started by typing into the searchbar - this is to avoid making two network requests instead of one\n      debouncedHandleSearch.cancel();\n      rawHandleSearch(searchTerm);\n    };\n\n    watch(route, () => {\n      hideSearch();\n      term.value = '';\n    });\n\n    return {\n      closeSearch,\n      showSearch,\n      hideSearch,\n      toggleSearch,\n      rawHandleSearch,\n      debouncedHandleSearch,\n      handleKeydownEnter,\n      term,\n    };\n  },\n});\n\n","import mod from \"-!../../../node_modules/babel-loader/lib/index.js??ref--13-0!../../../node_modules/ts-loader/index.js??ref--13-1!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../node_modules/unplugin/dist/webpack/loaders/transform.js??ref--15-0!./SearchBar.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../node_modules/babel-loader/lib/index.js??ref--13-0!../../../node_modules/ts-loader/index.js??ref--13-1!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../node_modules/unplugin/dist/webpack/loaders/transform.js??ref--15-0!./SearchBar.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./SearchBar.vue?vue&type=template&id=d3ca465c&scoped=true&\"\nimport script from \"./SearchBar.vue?vue&type=script&lang=ts&\"\nexport * from \"./SearchBar.vue?vue&type=script&lang=ts&\"\nfunction injectStyles (context) {\n  \n  var style0 = require(\"./SearchBar.vue?vue&type=style&index=0&id=d3ca465c&prod&lang=scss&scoped=true&\")\nif (style0.__inject__) style0.__inject__(context)\n\n}\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  injectStyles,\n  \"d3ca465c\",\n  \"68781b8e\"\n  \n)\n\nexport default component.exports"],"sourceRoot":""}
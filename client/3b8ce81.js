(window.webpackJsonp=window.webpackJsonp||[]).push([[108],{1009:function(e,t,n){"use strict";n.r(t);n(12),n(15),n(16),n(17);var r=n(11),o=n(2),l=n(4),c=(n(5),n(44),n(14),n(34),n(13),n(26),n(199)),d=n(209),f=n(49),v=n(588),m=n(0),h=n(485),_=n(483),S=n(650),y=n(521),O=n(30),j=n(210),w=n(57),D=n(207),address=n(594),N=n(499),A=n(547);function x(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function C(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?x(Object(source),!0).forEach((function(t){Object(l.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):x(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}Object(_.c)("required",C(C({},h.f),{},{message:"This field is required"})),Object(_.c)("min",C(C({},h.d),{},{message:"The field should have at least {length} characters"})),Object(_.c)("digits",C(C({},h.b),{},{message:"Please provide a valid phone number"}));var P=Object(m.b)({name:"ShippingStep",components:{SfHeading:c.a,SfInput:d.a,SfButton:f.a,SfSelect:v.a,ValidationProvider:_.b,ValidationObserver:_.a,UserShippingAddresses:function(){return n.e(96).then(n.bind(null,1027))},VsfShippingProvider:function(){return n.e(101).then(n.bind(null,1028))}},setup:function(){var e=Object(m.v)(),t=Object(m.s)().app,n=Object(m.l)(null),l=Object(j.a)(),c=l.load,d=l.save,f=l.loading,v=Object(D.a)(),h=v.load,_=v.setDefaultAddress,x=Object(O.e)(),P=x.load,k=x.search,$=Object(m.l)([]),I=Object(m.l)(null),V=Object(w.a)().isAuthenticated,R=Object(m.l)(Object(address.d)()),L=Object(m.l)([]),J=Object(m.l)(null),E=Object(m.l)(!1),F=Object(m.l)(!1),B=Object(m.l)(!0),H=Object(m.l)(!1),z=Object(m.a)((function(){return S.a.getAddresses(n.value)})),M=Object(m.a)((function(){return!f.value&&R.value&&Object.keys(R.value).length>0})),T=Object(m.a)((function(){return!(!V.value||!n.value)&&z.value.length>0})),U=Object(m.a)((function(){return y.a.countriesList($.value)})),Z=Object(m.a)((function(){return y.a.regionList(I.value)})),G=function(){var e=Object(o.a)(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=null==t?void 0:t.id,J.value=n,n&&(B.value=!1),R.value=Object(address.a)(t),!t.country_code){e.next=10;break}return e.next=7,k({id:t.country_code});case 7:e.t0=e.sent,e.next=11;break;case 10:e.t0=null;case 11:I.value=e.t0,H.value=!1;case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),K=function(e,t){R.value[e]=t,H.value=!1,J.value=null},Q=function(){var e=Object(o.a)(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return K("country_code",t),e.next=3,k({id:t});case 3:n=e.sent,R.value.region="",I.value=n;case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(m.g)(Object(o.a)(regeneratorRuntime.mark((function o(){var l,d,f,v,m,_,y,O,j,w,D;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,Object(A.a)("user-account");case 2:if(o.sent){o.next=6;break}return o.next=6,e.push(t.localeRoute({name:"user-account"}));case 6:return o.next=8,Promise.all([c(),h(),P()]);case 8:if(d=o.sent,f=Object(r.a)(d,3),v=f[0],m=f[1],_=f[2],y=S.a.getAddresses(m,{default_shipping:!0}),O=Object(r.a)(y,1),j=O[0],w=void 0===j?null:j,Boolean(v)?(D=Object(address.b)(null==m?void 0:m.addresses,v),G(C(C({},v),{},{id:null==D?void 0:D.id}))):w&&G(w),!(null===(l=R.value)||void 0===l?void 0:l.country_code)){o.next=20;break}return o.next=19,k({id:R.value.country_code});case 19:I.value=o.sent;case 20:n.value=m,$.value=_;case 22:case"end":return o.stop()}}),o)})))),{isAddNewAddressFormVisible:B,canMoveForward:M,changeCountry:Q,changeShippingDetails:K,countries:$,countriesList:U,country:I,currentAddressId:J,handleAddNewAddressBtnClick:function(){J.value=null,R.value=Object(address.d)(),B.value=!0,H.value=!1},handleAddressSubmit:function(e){return Object(o.a)(regeneratorRuntime.mark((function t(){var o,l,c,f,v,m,y;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return l=J.value,c=C(C({},R.value),{},{customerAddressId:l,save_in_address_book:!1}),t.next=4,Object(N.b)("checkout",{shipping:c});case 4:return t.next=6,d({shippingDetails:c});case 6:if(f=t.sent,L.value=null!==(o=null==f?void 0:f.available_shipping_methods)&&void 0!==o?o:[],null===l||!E.value){t.next=17;break}if(v=S.a.getAddresses(n.value,{id:l}),m=Object(r.a)(v,1),(y=m[0]).default_shipping=E.value,!y){t.next=17;break}return t.next=14,_({address:y});case 14:return t.next=16,h(!0);case 16:n.value=t.sent;case 17:e(),H.value=!0;case 19:case"end":return t.stop()}}),t)})))},handleSetCurrentAddress:G,hasSavedShippingAddress:T,isAuthenticated:V,isFormSubmitted:F,isShippingDetailsStepCompleted:H,isShippingLoading:f,regionInformation:Z,searchCountry:k,isSetAsDefaultRequested:E,shippingDetails:R,shippingMethods:L,addresses:z}}}),k=P,$=(n(773),n(9)),component=Object($.a)(k,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("ValidationObserver",{scopedSlots:e._u([{key:"default",fn:function(t){var r=t.handleSubmit,o=t.dirty,l=t.reset;return[n("SfHeading",{directives:[{name:"e2e",rawName:"v-e2e",value:"shipping-heading",expression:"'shipping-heading'"}],staticClass:"sf-heading--left sf-heading--no-underline title",attrs:{level:3,title:e.$t("Shipping address")}}),e._v(" "),e.hasSavedShippingAddress?n("SfHeading",{directives:[{name:"e2e",rawName:"v-e2e",value:"shipping-heading",expression:"'shipping-heading'"}],staticClass:"sf-heading--left sf-heading--no-underline form-subtitle",attrs:{level:4,title:e.$t("Select previously saved address")}}):e._e(),e._v(" "),n("form",{on:{submit:function(t){t.preventDefault(),r(e.handleAddressSubmit(l))}}},[e.isAuthenticated&&e.hasSavedShippingAddress?n("UserShippingAddresses",{directives:[{name:"e2e",rawName:"v-e2e",value:"shipping-addresses",expression:"'shipping-addresses'"}],attrs:{"current-address-id":e.currentAddressId,"shipping-addresses":e.addresses,countries:e.countries},on:{setCurrentAddress:function(t){return e.handleSetCurrentAddress(t)}},model:{value:e.isSetAsDefaultRequested,callback:function(t){e.isSetAsDefaultRequested=t},expression:"isSetAsDefaultRequested"}}):e._e(),e._v(" "),e.isAddNewAddressFormVisible?n("div",{staticClass:"form"},[e.hasSavedShippingAddress?n("SfHeading",{directives:[{name:"e2e",rawName:"v-e2e",value:"shipping-heading",expression:"'shipping-heading'"}],staticClass:"sf-heading--left sf-heading--no-underline form-subtitle",attrs:{level:4,title:e.$t("Enter different address")}}):e._e(),e._v(" "),n("ValidationProvider",{attrs:{name:"firstname",rules:"required|min:2",slim:""},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.errors;return[n("SfInput",{directives:[{name:"e2e",rawName:"v-e2e",value:"shipping-firstName",expression:"'shipping-firstName'"}],staticClass:"form__element form__element--half",attrs:{value:e.shippingDetails.firstname,label:e.$t("First Name"),name:"firstName",required:"",valid:!r[0],"error-message":e.$t(r[0])},on:{input:function(t){return e.changeShippingDetails("firstname",t)}}})]}}],null,!0)}),e._v(" "),n("ValidationProvider",{attrs:{name:"lastname",rules:"required|min:2",slim:""},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.errors;return[n("SfInput",{directives:[{name:"e2e",rawName:"v-e2e",value:"shipping-lastName",expression:"'shipping-lastName'"}],staticClass:"form__element form__element--half form__element--half-even",attrs:{value:e.shippingDetails.lastname,label:e.$t("Last Name"),name:"lastName",required:"",valid:!r[0],"error-message":e.$t(r[0])},on:{input:function(t){return e.changeShippingDetails("lastname",t)}}})]}}],null,!0)}),e._v(" "),n("ValidationProvider",{attrs:{name:"street",rules:"required",slim:""},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.errors;return[n("SfInput",{directives:[{name:"e2e",rawName:"v-e2e",value:"shipping-streetName",expression:"'shipping-streetName'"}],staticClass:"form__element form__element--half",attrs:{value:e.shippingDetails.street,label:e.$t("Street Name"),name:"streetName",required:"",valid:!r[0],"error-message":e.$t(r[0])},on:{input:function(t){return e.changeShippingDetails("street",t)}}})]}}],null,!0)}),e._v(" "),n("ValidationProvider",{attrs:{name:"apartment",rules:"required|min:1",slim:""},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.errors;return[n("SfInput",{directives:[{name:"e2e",rawName:"v-e2e",value:"shipping-apartment",expression:"'shipping-apartment'"}],staticClass:"form__element form__element--half form__element--half-even",attrs:{value:e.shippingDetails.apartment,label:e.$t("House/Apartment number"),name:"apartment",required:"",valid:!r[0],"error-message":e.$t(r[0])},on:{input:function(t){return e.changeShippingDetails("apartment",t)}}})]}}],null,!0)}),e._v(" "),n("ValidationProvider",{attrs:{name:"city",rules:"required|min:2",slim:""},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.errors;return[n("SfInput",{directives:[{name:"e2e",rawName:"v-e2e",value:"shipping-city",expression:"'shipping-city'"}],staticClass:"form__element form__element--half",attrs:{value:e.shippingDetails.city,label:e.$t("City"),name:"city",required:"",valid:!r[0],"error-message":e.$t(r[0])},on:{input:function(t){return e.changeShippingDetails("city",t)}}})]}}],null,!0)}),e._v(" "),n("ValidationProvider",{attrs:{name:"region",rules:e.shippingDetails.country_code&&0!==e.regionInformation.length?"required|min:2":null,slim:""},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.errors;return[e.shippingDetails.country_code&&0!==e.regionInformation.length?n("SfSelect",{directives:[{name:"e2e",rawName:"v-e2e",value:"shipping-state",expression:"'shipping-state'"}],staticClass:"form__element form__element--half form__element--half-even form__select sf-select--underlined",attrs:{value:e.shippingDetails.region,label:e.$t("State/Province"),name:"state",valid:!r[0],"error-message":e.$t(r[0])},on:{input:function(t){return e.changeShippingDetails("region",t)}}},[n("SfSelectOption",{attrs:{value:""}}),e._v(" "),e._l(e.regionInformation,(function(t){return n("SfSelectOption",{key:t.id,attrs:{value:t.abbreviation}},[e._v("\n            "+e._s(t.label)+"\n          ")])}))],2):n("SfInput",{directives:[{name:"e2e",rawName:"v-e2e",value:"shipping-state",expression:"'shipping-state'"}],staticClass:"form__element form__element--half form__element--half-even",attrs:{value:e.shippingDetails.region,label:e.$t("State/Province"),disabled:!e.shippingDetails.country_code,name:"state",valid:!!e.shippingDetails.country_code,"error-message":e.shippingDetails.country_code?"":e.$t("Please select a country first")},on:{input:function(t){return e.changeShippingDetails("region",t)}}})]}}],null,!0)}),e._v(" "),n("ValidationProvider",{attrs:{name:"country",rules:"required|min:2",slim:""},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.errors;return[n("SfSelect",{directives:[{name:"e2e",rawName:"v-e2e",value:"shipping-country",expression:"'shipping-country'"}],staticClass:"form__element form__element--half form__select sf-select--underlined",attrs:{value:e.shippingDetails.country_code,label:e.$t("Country"),name:"country",required:"",valid:!r[0],"error-message":e.$t(r[0])},on:{input:e.changeCountry}},[n("SfSelectOption",{attrs:{value:""}}),e._v(" "),e._l(e.countriesList,(function(t){return n("SfSelectOption",{key:t.id,attrs:{value:t.abbreviation}},[e._v("\n            "+e._s(t.label)+"\n          ")])}))],2)]}}],null,!0)}),e._v(" "),n("ValidationProvider",{attrs:{name:"zipCode",rules:"required|min:2",slim:""},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.errors;return[n("SfInput",{directives:[{name:"e2e",rawName:"v-e2e",value:"shipping-zipcode",expression:"'shipping-zipcode'"}],staticClass:"form__element form__element--half form__element--half-even",attrs:{value:e.shippingDetails.postcode,label:e.$t("Zip-code"),name:"zipCode",required:"",valid:!r[0],"error-message":e.$t(r[0])},on:{input:function(t){return e.changeShippingDetails("postcode",t)}}})]}}],null,!0)}),e._v(" "),n("ValidationProvider",{attrs:{name:"phone",rules:"required|min:8",slim:""},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.errors;return[n("SfInput",{directives:[{name:"e2e",rawName:"v-e2e",value:"shipping-phone",expression:"'shipping-phone'"}],staticClass:"form__element form__element--half",attrs:{label:e.$t("Phone number"),name:"phone",required:"",valid:!r[0],"error-message":e.$t(r[0])},on:{input:function(t){return e.changeShippingDetails("telephone",t)}},model:{value:e.shippingDetails.telephone,callback:function(t){e.$set(e.shippingDetails,"telephone",t)},expression:"shippingDetails.telephone"}})]}}],null,!0)})],1):e._e(),e._v(" "),e.isAddNewAddressFormVisible?e._e():n("SfButton",{staticClass:"color-light form__action-button form__action-button--add-address",attrs:{type:"submit"},on:{click:e.handleAddNewAddressBtnClick}},[e._v("\n      "+e._s(e.$t("Add new address"))+"\n    ")]),e._v(" "),n("div",{staticClass:"form"},[n("div",{staticClass:"form__action"},[!e.isShippingDetailsStepCompleted||o?n("SfButton",{directives:[{name:"e2e",rawName:"v-e2e",value:"select-shipping",expression:"'select-shipping'"}],staticClass:"form__action-button",attrs:{disabled:e.isShippingLoading,type:"submit"}},[e._v("\n          "+e._s(e.$t("Select shipping method"))+"\n        ")]):e._e()],1)]),e._v(" "),e.isShippingDetailsStepCompleted&&!o?n("VsfShippingProvider",{attrs:{"shipping-methods":e.shippingMethods},on:{submit:function(t){e.$router.push(e.localeRoute({name:"billing"}))}}}):e._e()],1)]}}])})}),[],!1,null,"4120bf6e",null);t.default=component.exports},499:function(e,t,n){"use strict";n.d(t,"a",(function(){return f})),n.d(t,"c",(function(){return v})),n.d(t,"b",(function(){return m}));n(14),n(12),n(15),n(16),n(17);var r=n(4);n(13);function o(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function l(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?o(Object(source),!0).forEach((function(t){Object(r.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):o(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var c=function(e){return"vsf-".concat(e)},d=function(e,t){return new Promise((function(n,r){try{var o=e();t&&t(null,o),n(o)}catch(e){t&&t(e),r(e)}}))},f=function(e,t){return d((function(){return JSON.parse(window.localStorage.getItem(c(e)))}),t)},v=function(e,t){return d((function(){window.localStorage.removeItem(c(e))}),t)},m=function(e,t,n){return d((function(){return function(e,t){var n=window.localStorage.getItem(e),r=JSON.parse(n),o=t,c=JSON.stringify(l(l({},JSON.parse(JSON.stringify(r))),JSON.parse(JSON.stringify(o))));window.localStorage.setItem(e,c)}(c(e),t)}),n)}},521:function(e,t,n){"use strict";n(20),n(15),n(21);t.a={countriesList:function(e){return e.filter((function(e){return e.id&&e.full_name_english&&e.full_name_locale})).map((function(e){return{id:e.id,label:e.full_name_locale,englishLabel:e.full_name_english,abbreviation:e.two_letter_abbreviation}})).sort((function(a,b){return a.label.localeCompare(b.label)}))},regionList:function(e){return(null==e?void 0:e.available_regions)?e.available_regions.filter((function(e){return e.id&&e.code&&e.name})).map((function(e){return{id:e.id,label:e.name,abbreviation:e.code}})).sort((function(a,b){return a.label.localeCompare(b.label)})):[]}}},547:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(2),o=(n(5),n(499)),l=function(){var e=Object(r.a)(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(o.a)("checkout");case 2:return n=e.sent,e.abrupt("return",!(!n||!n[t]));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},594:function(e,t,n){"use strict";n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return l})),n.d(t,"d",(function(){return c})),n.d(t,"b",(function(){return d}));n(58);var r=n(984),o=function(address){return{firstname:address.firstname,lastname:address.lastname,street:address.street[0],apartment:address.street[1],city:address.city,region:address.region.code,country_code:address.country.code,postcode:address.postcode,telephone:address.telephone}},l=function(address){var e,t,n,r,o;return{firstname:address.firstname,lastname:address.lastname,street:null===(e=address.street)||void 0===e?void 0:e[0],apartment:null===(t=address.street)||void 0===t?void 0:t[1],city:address.city,region:null!==(r=null===(n=null==address?void 0:address.region)||void 0===n?void 0:n.region_code)&&void 0!==r?r:address.region.code,country_code:null!==(o=null==address?void 0:address.country_code)&&void 0!==o?o:address.country.code,postcode:address.postcode,telephone:address.telephone}},c=function(){return{firstname:"",lastname:"",street:"",apartment:"",city:"",region:"",country_code:"",postcode:"",telephone:""}},d=function(e,t){var n;return null!==(n=null==e?void 0:e.find((function(e){return Object(r.a)(l(e),l(t))})))&&void 0!==n?n:null}},650:function(e,t,n){"use strict";var r=n(11),o=(n(14),n(87),n(15),n(58),n(1)),l={getAddresses:function(e,t){if(o.a.debug(e),!e||!e.addresses)return[];if(!t||0===Object.keys(t).length)return e.addresses;var n=Object.entries(t);return e.addresses.filter((function(address){return n.every((function(e){var t=Object(r.a)(e,2),n=t[0],o=t[1];return address[n]===o}))}))},getDefault:function(e){return e.addresses.find((function(e){return e.default_shipping}))},getTotal:function(e){return e.addresses.length},getPostCode:function(address){return(null==address?void 0:address.postcode)||""},getStreetName:function(address){return Array.isArray(null==address?void 0:address.street)?null==address?void 0:address.street[0]:""},getApartmentNumber:function(address){return Array.isArray(null==address?void 0:address.street)?null==address?void 0:address.street[1]:""},getCity:function(address){return(null==address?void 0:address.city)||""},getFirstName:function(address){return(null==address?void 0:address.firstname)||""},getLastName:function(address){return(null==address?void 0:address.lastname)||""},getCountry:function(address){return(null==address?void 0:address.country_code)||""},getPhone:function(address){return(null==address?void 0:address.phone)||""},getEmail:function(address){return(null==address?void 0:address.email)||""},getProvince:function(address){var e,t;return(null===(e=null==address?void 0:address.region)||void 0===e?void 0:e.region_code)||(null===(t=null==address?void 0:address.region)||void 0===t?void 0:t.region)||""},getCompanyName:function(address){return(null==address?void 0:address.company)||""},getId:function(address){return(null==address?void 0:address.id)||""},isDefault:function(address){return(null==address?void 0:address.default_shipping)||!1}};t.a=l},651:function(e,t,n){},773:function(e,t,n){"use strict";n(651)}}]);
//# sourceMappingURL=3b8ce81.js.map
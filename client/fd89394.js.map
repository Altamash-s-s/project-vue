{"version":3,"sources":["webpack:///./modules/checkout/pages/Checkout/Payment.vue?ec10","webpack:///./modules/checkout/pages/Checkout/Payment.vue?4315","webpack:///./modules/checkout/pages/Checkout/Payment.vue?e6fc","webpack:///./modules/checkout/pages/Checkout/Payment.vue","webpack:///./helpers/asyncLocalStorage.ts","webpack:///./helpers/checkout/getShippingMethodPrice.ts","webpack:///./helpers/checkout/steps.ts","webpack:///./modules/checkout/pages/Checkout/Payment.vue?88e0"],"names":["defineComponent","name","components","SfHeading","SfTable","SfCheckbox","SfButton","SfDivider","SfPrice","SfProperty","SfLink","SfImage","VsfPaymentProvider","setup","order","ref","useCart","cart","load","setCart","useMakeOrder","make","loading","app","useContext","router","useRouter","isPaymentReady","terms","onMounted","isPreviousStepValid","push","localePath","processOrder","value","$vsf","$magento","config","state","removeCartId","removeItem","thankYouRoute","localeRoute","query","order_number","discounts","computed","cartGetters","getDiscounts","hasDiscounts","length","discountsAmount","reduce","a","el","useImage","getMagentoImage","imageSizes","getShippingMethodPrice","products","getItems","selectedShippingMethod","getSelectedShippingMethod","tableHeaders","totals","getTotals","getAttributes","product","configurable_options","getBundles","bundle_options","map","b","values","flat","getRowTotal","getItemPrice","regular","special","component","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","$t","_v","_s","_l","tableHeader","key","class","table__description","index","getItemImage","getItemName","checkout","imageWidth","imageHeight","fit","getItemSku","attr","option_label","_e","bundle","label","getItemQty","$fc","subtotal","scopedSlots","_u","fn","carrier_title","method_title","proxy","total","on","$event","directives","rawName","expression","model","callback","$$v","$router","getVsfKey","createPromise","getValue","Promise","resolve","reject","err","getItem","JSON","parse","window","localStorage","mergeItem","oldValue","oldObject","newObject","nextValue","stringify","setItem","mergeLocalStorageItem","shippingMethod","amount","priceWithTax","price_incl_tax","stepToValidate"],"mappings":"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","file":"fd89394.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('SfHeading',{staticClass:\"sf-heading--left sf-heading--no-underline title\",attrs:{\"level\":3,\"title\":_vm.$t('Payment')}}),_vm._v(\" \"),_c('SfTable',{staticClass:\"sf-table--bordered table desktop-only\"},[_c('SfTableHeading',{staticClass:\"table__row\"},[_c('SfTableHeader',{staticClass:\"table__header table__image\"},[_vm._v(\"\\n        \"+_vm._s(_vm.$t('Item'))+\"\\n      \")]),_vm._v(\" \"),_vm._l((_vm.tableHeaders),function(tableHeader){return _c('SfTableHeader',{key:tableHeader,staticClass:\"table__header\",class:{ table__description: tableHeader === 'Description' }},[_vm._v(\"\\n        \"+_vm._s(_vm.$t(tableHeader))+\"\\n      \")])})],2),_vm._v(\" \"),_vm._l((_vm.products),function(product,index){return _c('SfTableRow',{key:index,staticClass:\"table__row\"},[_c('SfTableData',{staticClass:\"table__image\"},[_c('SfImage',{attrs:{\"image-tag\":\"nuxt-img\",\"src\":_vm.getMagentoImage(_vm.cartGetters.getItemImage(product)),\"alt\":_vm.cartGetters.getItemName(product),\"width\":_vm.imageSizes.checkout.imageWidth,\"height\":_vm.imageSizes.checkout.imageHeight,\"nuxt-img-config\":{\n            fit: 'cover',\n          }}})],1),_vm._v(\" \"),_c('SfTableData',{staticClass:\"table__data table__description table__data\"},[_c('div',{staticClass:\"product-title\"},[_vm._v(\"\\n          \"+_vm._s(_vm.cartGetters.getItemName(product))+\"\\n        \")]),_vm._v(\" \"),_c('div',{staticClass:\"product-sku\"},[_vm._v(\"\\n          \"+_vm._s(_vm.cartGetters.getItemSku(product))+\"\\n        \")]),_vm._v(\" \"),(_vm.getAttributes(product).length > 0)?_vm._l((_vm.getAttributes(product)),function(attr){return _c('p',{key:attr.option_label,staticClass:\"detail-information\"},[_c('strong',[_vm._v(_vm._s(((attr.option_label) + \":\")))]),_vm._v(_vm._s((\"\" + (attr.value_label)))+\"\\n          \")])}):_vm._e(),_vm._v(\" \"),(_vm.getBundles(product).length > 0)?_vm._l((_vm.getBundles(product)),function(bundle){return _c('p',{key:bundle.label,staticClass:\"detail-information\"},[_vm._v(\"\\n            \"+_vm._s(((bundle.quantity) + \"x \" + (bundle.label)))+\"\\n          \")])}):_vm._e()],2),_vm._v(\" \"),_c('SfTableData',{staticClass:\"table__data\"},[_vm._v(\"\\n        \"+_vm._s(_vm.cartGetters.getItemQty(product))+\"\\n      \")]),_vm._v(\" \"),_c('SfTableData',{staticClass:\"table__data price\"},[_c('SfPrice',{staticClass:\"product-price\",attrs:{\"regular\":_vm.$fc(_vm.cartGetters.getItemPrice(product).regular),\"special\":_vm.cartGetters.getItemPrice(product).special && _vm.$fc(_vm.getRowTotal(product))}})],1)],1)})],2),_vm._v(\" \"),_c('div',{staticClass:\"summary\"},[_c('div',{staticClass:\"summary__group\"},[_c('div',{staticClass:\"summary__total\"},[_c('SfProperty',{staticClass:\"sf-property--full-width property\",attrs:{\"name\":_vm.$t('Subtotal'),\"value\":_vm.$fc(_vm.totals.subtotal)}}),_vm._v(\" \"),(_vm.hasDiscounts)?_c('SfProperty',{staticClass:\"sf-property--full-width sf-property--small property\",attrs:{\"name\":_vm.$t('Discount'),\"value\":_vm.$fc(_vm.discountsAmount)}}):_vm._e()],1),_vm._v(\" \"),(_vm.selectedShippingMethod)?_c('div',{staticClass:\"summary__total\"},[_c('SfProperty',{staticClass:\"sf-property--full-width property\",attrs:{\"value\":_vm.$fc(_vm.getShippingMethodPrice(_vm.selectedShippingMethod))},scopedSlots:_vm._u([{key:\"name\",fn:function(){return [_c('span',{staticClass:\"sf-property__name\"},[_vm._v(\"\\n              \"+_vm._s(_vm.selectedShippingMethod.carrier_title)+\" (\"),_c('small',[_vm._v(_vm._s(_vm.selectedShippingMethod.method_title))]),_vm._v(\")\\n            \")])]},proxy:true}],null,false,323593557)})],1):_vm._e(),_vm._v(\" \"),_c('SfDivider'),_vm._v(\" \"),_c('SfProperty',{staticClass:\"sf-property--full-width sf-property--large summary__property-total\",attrs:{\"name\":_vm.$t('Total price'),\"value\":_vm.$fc(_vm.totals.total)}}),_vm._v(\" \"),_c('VsfPaymentProvider',{on:{\"status\":function($event){_vm.isPaymentReady = true}}}),_vm._v(\" \"),_c('SfCheckbox',{directives:[{name:\"e2e\",rawName:\"v-e2e\",value:('terms'),expression:\"'terms'\"}],staticClass:\"summary__terms\",attrs:{\"name\":\"terms\"},scopedSlots:_vm._u([{key:\"label\",fn:function(){return [_c('div',{staticClass:\"sf-checkbox__label\"},[_vm._v(\"\\n            \"+_vm._s(_vm.$t('I agree to'))+\"\\n            \"),_c('SfLink',{attrs:{\"link\":\"#\"}},[_vm._v(\"\\n              \"+_vm._s(_vm.$t('Terms and conditions'))+\"\\n            \")])],1)]},proxy:true}]),model:{value:(_vm.terms),callback:function ($$v) {_vm.terms=$$v},expression:\"terms\"}}),_vm._v(\" \"),_c('div',{staticClass:\"summary__action\"},[_c('SfButton',{staticClass:\"sf-button color-secondary summary__back-button\",attrs:{\"type\":\"button\"},on:{\"click\":function($event){_vm.$router.push((\"\" + (_vm.localePath('/checkout/billing'))))}}},[_vm._v(\"\\n          \"+_vm._s(_vm.$t('Go back'))+\"\\n        \")]),_vm._v(\" \"),_c('SfButton',{directives:[{name:\"e2e\",rawName:\"v-e2e\",value:('make-an-order'),expression:\"'make-an-order'\"}],staticClass:\"summary__action-button\",attrs:{\"disabled\":_vm.loading || !_vm.isPaymentReady || !_vm.terms},on:{\"click\":_vm.processOrder}},[_vm._v(\"\\n          \"+_vm._s(_vm.$t('Make an order'))+\"\\n        \")])],1)],1)])],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport {\n  SfHeading,\n  SfTable,\n  SfCheckbox,\n  SfButton,\n  SfDivider,\n  SfPrice,\n  SfProperty,\n  SfLink,\n  SfImage,\n} from '@storefront-ui/vue';\nimport {\n  ref,\n  computed,\n  defineComponent,\n  useRouter,\n  useContext,\n  onMounted,\n} from '@nuxtjs/composition-api';\n\nimport cartGetters from '~/modules/checkout/getters/cartGetters';\nimport { useImage } from '~/composables';\nimport useMakeOrder from '~/modules/checkout/composables/useMakeOrder';\nimport useCart from '~/modules/checkout/composables/useCart';\nimport getShippingMethodPrice from '~/helpers/checkout/getShippingMethodPrice';\nimport { removeItem } from '~/helpers/asyncLocalStorage';\nimport { isPreviousStepValid } from '~/helpers/checkout/steps';\nimport type { BundleCartItem, ConfigurableCartItem, CartItemInterface } from '~/modules/GraphQL/types';\n\nexport default defineComponent({\n  name: 'ReviewOrderAndPayment',\n  components: {\n    SfHeading,\n    SfTable,\n    SfCheckbox,\n    SfButton,\n    SfDivider,\n    SfPrice,\n    SfProperty,\n    SfLink,\n    SfImage,\n    VsfPaymentProvider: () => import('~/modules/checkout/components/VsfPaymentProvider.vue'),\n  },\n  setup() {\n    const order = ref(null);\n    const { cart, load, setCart } = useCart();\n    const { make, loading } = useMakeOrder();\n    const { app } = useContext();\n    const router = useRouter();\n    const isPaymentReady = ref(false);\n    const terms = ref(false);\n    const getAttributes = (product: ConfigurableCartItem) => product.configurable_options || [];\n    const getBundles = (product: BundleCartItem) => product.bundle_options?.map((b) => b.values).flat() || [];\n\n    onMounted(async () => {\n      const validStep = await isPreviousStepValid('billing');\n      if (!validStep) {\n        await router.push(app.localePath('/checkout/user-account'));\n      }\n\n      await load();\n    });\n\n    const processOrder = async () => {\n      order.value = await make();\n      setCart(null);\n      app.$vsf.$magento.config.state.removeCartId();\n      await load();\n      await removeItem('checkout');\n      const thankYouRoute = app.localeRoute({\n        name: 'thank-you',\n        query: {\n          order: order.value.order.order_number,\n        },\n      });\n      await router.push(thankYouRoute);\n    };\n\n    const discounts = computed(() => cartGetters.getDiscounts(cart.value));\n    const hasDiscounts = computed(() => discounts.value.length > 0);\n    const discountsAmount = computed(\n      () => -1 * discounts.value.reduce((a, el) => el.value + a, 0),\n    );\n\n    const { getMagentoImage, imageSizes } = useImage();\n    const getRowTotal = (product: CartItemInterface) => cartGetters.getItemPrice(product).regular - cartGetters.getItemPrice(product).special;\n    return {\n      cart,\n      cartGetters,\n      discounts,\n      hasDiscounts,\n      discountsAmount,\n      getShippingMethodPrice,\n      isPaymentReady,\n      loading,\n      processOrder,\n      products: computed(() => cartGetters.getItems(cart.value)),\n      selectedShippingMethod: computed(() => cartGetters.getSelectedShippingMethod(cart.value)),\n      tableHeaders: ['Description', 'Quantity', 'Amount'],\n      terms,\n      totals: computed(() => cartGetters.getTotals(cart.value)),\n      getAttributes,\n      getBundles,\n      getMagentoImage,\n      imageSizes,\n      getRowTotal,\n    };\n  },\n});\n","import mod from \"-!../../../../node_modules/babel-loader/lib/index.js??ref--13-0!../../../../node_modules/ts-loader/index.js??ref--13-1!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../../node_modules/unplugin/dist/webpack/loaders/transform.js??ref--15-0!./Payment.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../node_modules/babel-loader/lib/index.js??ref--13-0!../../../../node_modules/ts-loader/index.js??ref--13-1!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../../node_modules/unplugin/dist/webpack/loaders/transform.js??ref--15-0!./Payment.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./Payment.vue?vue&type=template&id=3526570a&scoped=true&\"\nimport script from \"./Payment.vue?vue&type=script&lang=ts&\"\nexport * from \"./Payment.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./Payment.vue?vue&type=style&index=0&id=3526570a&prod&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"3526570a\",\n  null\n  \n)\n\nexport default component.exports","const getVsfKey = (key: string) => `vsf-${key}`;\n\ntype Callback<TValue> = (error: Error | null, value?: TValue) => void;\n\nconst mergeLocalStorageItem = (key: string, value: Record<string, unknown>) : void => {\n  const oldValue = window.localStorage.getItem(key);\n  const oldObject = JSON.parse(oldValue);\n  const newObject = value;\n  const nextValue = JSON.stringify({\n    ...JSON.parse(JSON.stringify(oldObject)),\n    ...JSON.parse(JSON.stringify(newObject)),\n  });\n  window.localStorage.setItem(key, nextValue);\n};\n\nconst createPromise = <TValue>(\n  getValue: () => TValue,\n  callback: Callback<TValue>,\n) : Promise<TValue> => new Promise((resolve, reject) => {\n  try {\n    const value = getValue();\n    if (callback) {\n      callback(null, value);\n    }\n    resolve(value);\n  } catch (err) {\n    if (callback) {\n      callback(err as Error);\n    }\n    reject(err);\n  }\n});\n\nexport const getItem = <T = unknown>(\n  key: string,\n  callback?: Callback<T>,\n): Promise<T> => createPromise(() => JSON.parse(window.localStorage.getItem(getVsfKey(key))), callback);\n\nexport const setItem = <T = unknown>(\n  key: string,\n  value: T,\n  callback?: Callback<void>,\n): Promise<void> => createPromise(() => (window.localStorage.setItem(getVsfKey(key), JSON.stringify(value))), callback);\n\nexport const removeItem = (\n  key: string,\n  callback?: Callback<void>,\n): Promise<void> => createPromise(() => {\n  window.localStorage.removeItem(getVsfKey(key));\n}, callback);\n\nexport const mergeItem = (\n  key: string,\n  value: Record<string, unknown>,\n  callback?: Callback<void>,\n): Promise<void> => createPromise(() => mergeLocalStorageItem(getVsfKey(key), value), callback);\n\nexport const clear = (callback?: Callback<void>): Promise<void> => createPromise(() => {\n  window.localStorage.clear();\n}, callback);\n","import { AvailableShippingMethod } from '~/modules/GraphQL/types';\n\nexport default (shippingMethod: AvailableShippingMethod) => {\n  const value = shippingMethod?.amount?.value;\n  const priceWithTax = shippingMethod?.price_incl_tax?.value;\n\n  return priceWithTax > 0 && priceWithTax > value ? priceWithTax : value;\n};\n","import { getItem } from '~/helpers/asyncLocalStorage';\n\nexport const isPreviousStepValid = async (stepToValidate: string) => {\n  const checkout = await getItem('checkout');\n  return !(!checkout || !checkout[stepToValidate]);\n};\n","export * from \"-!../../../../node_modules/extract-css-chunks-webpack-plugin/dist/loader.js??ref--7-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../../../../node_modules/sass-loader/dist/cjs.js??ref--7-oneOf-1-3!../../../../node_modules/sass-resources-loader/lib/loader.js??ref--7-oneOf-1-4!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../../node_modules/unplugin/dist/webpack/loaders/transform.js??ref--15-0!./Payment.vue?vue&type=style&index=0&id=3526570a&prod&lang=scss&scoped=true&\""],"sourceRoot":""}
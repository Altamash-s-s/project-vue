{"version":3,"sources":["webpack:///./components/Header/SearchBar/SearchBar.vue?37b4","webpack:///./components/directives/click-outside/click-outside-directive.ts","webpack:///./components/Header/SearchBar/SearchBar.vue?82cc","webpack:///./components/Header/SearchBar/SearchBar.vue?6e2a","webpack:///./components/Header/SearchBar/SearchBar.vue","webpack:///./components/Header/SearchBar/SearchBar.vue?0dc2"],"names":["clickOutside","bind","el","binding","closeHandler","value","_outsideClickHandler","event","contains","target","stopPropagation","document","addEventListener","unbind","removeEventListener","defineComponent","name","components","SfSearchBar","SfButton","SvgImage","directives","props","isSearchOpen","type","Boolean","default","itemsPerPage","Number","minTermLen","emits","setup","emit","term","ref","route","useRoute","getProductList","useProduct","showSearch","body","classList","add","hideSearch","remove","rawHandleSearch","searchTerm","length","pageSize","search","productList","items","debouncedHandleSearch","debounce","watch","closeSearch","searchResultsEl","querySelector","closeTriggerElement","toggleSearch","handleKeydownEnter","cancel","component","_vm","this","_h","$createElement","_c","_self","rawName","expression","staticClass","attrs","$t","on","$event","indexOf","_k","keyCode","key","apply","arguments","scopedSlots","_u","fn","proxy"],"mappings":"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","file":"796341d.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('SfSearchBar',{directives:[{name:\"click-outside\",rawName:\"v-click-outside\",value:(_vm.closeSearch),expression:\"closeSearch\"}],staticClass:\"sf-header__search\",attrs:{\"placeholder\":_vm.$t('Search for items'),\"aria-label\":\"Search\",\"value\":_vm.term},on:{\"input\":function($event){return _vm.debouncedHandleSearch($event)},\"keyup\":function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"enter\",13,$event.key,\"Enter\")){ return null; }_vm.handleKeydownEnter($event.target.value) /* https://github.com/vuestorefront/storefront-ui/issues/2453#issuecomment-1160231619 */},\"keydown\":[function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"tab\",9,$event.key,\"Tab\")){ return null; }return _vm.hideSearch.apply(null, arguments)},function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"esc\",27,$event.key,[\"Esc\",\"Escape\"])){ return null; }return _vm.closeSearch.apply(null, arguments)}],\"focus\":_vm.showSearch,\"click\":_vm.showSearch},scopedSlots:_vm._u([{key:\"icon\",fn:function(){return [(!!_vm.term)?_c('SfButton',{staticClass:\"sf-search-bar__button sf-button--pure\",attrs:{\"aria-label\":\"Close search\"},on:{\"click\":_vm.closeSearch}},[_c('span',{staticClass:\"sf-search-bar__icon\"},[_c('SvgImage',{attrs:{\"icon\":\"cross\",\"label\":_vm.$t('Cancel'),\"width\":\"18\",\"height\":\"18\"}})],1)]):_c('SfButton',{staticClass:\"sf-search-bar__button sf-button--pure\",attrs:{\"aria-label\":\"Open search\"},on:{\"click\":_vm.toggleSearch,\"keydown\":function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"tab\",9,$event.key,\"Tab\")){ return null; }return _vm.hideSearch.apply(null, arguments)}}},[_c('span',{staticClass:\"sf-search-bar__icon\"},[_c('SvgImage',{attrs:{\"icon\":\"search\",\"label\":_vm.$t('Search'),\"width\":\"18\",\"height\":\"18\"}})],1)])]},proxy:true}])})}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","/* eslint-disable no-underscore-dangle */\n/* eslint-disable no-param-reassign */\n\nimport { DirectiveOptions } from 'vue';\n\ntype ElementWithClickOutsideListener = HTMLElement & { _outsideClickHandler: (e: MouseEvent) => void };\nexport const clickOutside : DirectiveOptions = {\n  bind(el: ElementWithClickOutsideListener, binding) {\n    const closeHandler = binding.value;\n\n    el._outsideClickHandler = (event: MouseEvent) => {\n      if (!el.contains(event.target as Node)) {\n        event.stopPropagation();\n        closeHandler(event, el);\n      }\n    };\n\n    document.addEventListener('mousedown', el._outsideClickHandler);\n    document.addEventListener('touchstart', el._outsideClickHandler);\n  },\n  unbind(el: ElementWithClickOutsideListener) {\n    document.removeEventListener('mousedown', el._outsideClickHandler);\n    document.removeEventListener('touchstart', el._outsideClickHandler);\n    el._outsideClickHandler = null;\n  },\n};\n","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { SfButton, SfSearchBar } from '@storefront-ui/vue';\nimport {\n  defineComponent, ref, watch, useRoute,\n} from '@nuxtjs/composition-api';\nimport { debounce } from 'lodash-es';\nimport { clickOutside } from '~/components/directives/click-outside/click-outside-directive';\nimport SvgImage from '~/components/General/SvgImage.vue';\nimport { useProduct } from '~/modules/catalog/product/composables/useProduct';\nimport { Products } from '~/modules/GraphQL/types';\n\nexport default defineComponent({\n  name: 'SearchBar',\n  components: {\n    SfSearchBar,\n    SfButton,\n    SvgImage,\n  },\n  directives: { clickOutside },\n  props: {\n    isSearchOpen: {\n      type: Boolean,\n      default: false,\n    },\n    itemsPerPage: {\n      type: Number,\n      default: 12,\n    },\n    minTermLen: {\n      type: Number,\n      default: 3,\n    },\n  },\n  emits: ['set-is-open', 'set-search-results'],\n  setup(props, { emit }) {\n    const term = ref('');\n    const route = useRoute();\n\n    const { getProductList } = useProduct();\n\n    const showSearch = () => {\n      if (!props.isSearchOpen) {\n        emit('set-is-open', true);\n        if (document) {\n          document.body.classList.add('no-scroll');\n        }\n      }\n    };\n\n    const hideSearch = () => {\n      if (props.isSearchOpen) {\n        emit('set-is-open', false);\n        emit('set-search-results', null);\n        if (document) {\n          document.body.classList.remove('no-scroll');\n        }\n      }\n    };\n\n    const toggleSearch = () => {\n      if (props.isSearchOpen) {\n        hideSearch();\n      } else {\n        showSearch();\n      }\n    };\n\n    const closeSearch = (event: MouseEvent) => {\n      if (document) {\n        const searchResultsEl = document.querySelector('.search');\n        const closeTriggerElement = event.target as HTMLElement;\n\n        if (!searchResultsEl?.contains(closeTriggerElement)) {\n          hideSearch();\n          term.value = '';\n        }\n      } else {\n        hideSearch();\n        term.value = '';\n      }\n    };\n\n    const rawHandleSearch = async (searchTerm: string) => {\n      term.value = searchTerm;\n      if (term.value.length < props.minTermLen) return;\n\n      // M2-579\n      const productList : Products = await getProductList({\n        pageSize: props.itemsPerPage,\n        search: term.value,\n      }) as unknown as Products;\n\n      emit('set-search-results', productList!.items);\n    };\n\n    const debouncedHandleSearch = debounce(rawHandleSearch, 1000);\n\n    const handleKeydownEnter = (searchTerm: string) => {\n      // cancel debounce timeout started by typing into the searchbar - this is to avoid making two network requests instead of one\n      debouncedHandleSearch.cancel();\n      rawHandleSearch(searchTerm);\n    };\n\n    watch(route, () => {\n      hideSearch();\n      term.value = '';\n    });\n\n    return {\n      closeSearch,\n      showSearch,\n      hideSearch,\n      toggleSearch,\n      rawHandleSearch,\n      debouncedHandleSearch,\n      handleKeydownEnter,\n      term,\n    };\n  },\n});\n\n","import mod from \"-!../../../node_modules/babel-loader/lib/index.js??ref--13-0!../../../node_modules/ts-loader/index.js??ref--13-1!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../node_modules/unplugin/dist/webpack/loaders/transform.js??ref--15-0!./SearchBar.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../node_modules/babel-loader/lib/index.js??ref--13-0!../../../node_modules/ts-loader/index.js??ref--13-1!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../node_modules/unplugin/dist/webpack/loaders/transform.js??ref--15-0!./SearchBar.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./SearchBar.vue?vue&type=template&id=d3ca465c&scoped=true&\"\nimport script from \"./SearchBar.vue?vue&type=script&lang=ts&\"\nexport * from \"./SearchBar.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./SearchBar.vue?vue&type=style&index=0&id=d3ca465c&prod&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"d3ca465c\",\n  null\n  \n)\n\nexport default component.exports","export * from \"-!../../../node_modules/extract-css-chunks-webpack-plugin/dist/loader.js??ref--7-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--7-oneOf-1-3!../../../node_modules/sass-resources-loader/lib/loader.js??ref--7-oneOf-1-4!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../node_modules/unplugin/dist/webpack/loaders/transform.js??ref--15-0!./SearchBar.vue?vue&type=style&index=0&id=d3ca465c&prod&lang=scss&scoped=true&\""],"sourceRoot":""}
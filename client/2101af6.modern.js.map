{"version":3,"sources":["webpack:///./helpers/asyncLocalStorage.ts","webpack:///./helpers/checkout/getShippingMethodPrice.ts","webpack:///./helpers/checkout/steps.ts","webpack:///./modules/checkout/pages/Checkout/Payment.vue?88e0","webpack:///./modules/checkout/pages/Checkout/Payment.vue?ec10","webpack:///./modules/checkout/pages/Checkout/Payment.vue?4315","webpack:///./modules/checkout/pages/Checkout/Payment.vue?e6fc","webpack:///./modules/checkout/pages/Checkout/Payment.vue"],"names":["getVsfKey","key","createPromise","getValue","callback","Promise","resolve","reject","value","err","getItem","JSON","parse","window","localStorage","removeItem","mergeItem","oldValue","oldObject","newObject","nextValue","stringify","setItem","mergeLocalStorageItem","shippingMethod","amount","priceWithTax","price_incl_tax","isPreviousStepValid","stepToValidate","checkout","defineComponent","name","components","SfHeading","SfTable","SfCheckbox","SfButton","SfDivider","SfPrice","SfProperty","SfLink","SfImage","VsfPaymentProvider","setup","order","ref","cart","load","setCart","useCart","make","loading","useMakeOrder","app","useContext","router","useRouter","isPaymentReady","terms","onMounted","push","localePath","processOrder","$vsf","$magento","config","state","removeCartId","thankYouRoute","localeRoute","query","order_number","discounts","computed","cartGetters","getDiscounts","hasDiscounts","length","discountsAmount","reduce","a","el","getMagentoImage","imageSizes","useImage","getShippingMethodPrice","products","getItems","selectedShippingMethod","getSelectedShippingMethod","tableHeaders","totals","getTotals","getAttributes","product","configurable_options","getBundles","bundle_options","map","b","values","flat","getRowTotal","getItemPrice","regular","special","component","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","$t","_v","_s","_l","tableHeader","class","table__description","index","getItemImage","getItemName","imageWidth","imageHeight","fit","getItemSku","attr","option_label","_e","bundle","label","getItemQty","$fc","subtotal","scopedSlots","_u","fn","carrier_title","method_title","proxy","total","on","$event","directives","rawName","expression","model","$$v","$router"],"mappings":"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","file":"2101af6.modern.js","sourcesContent":["const getVsfKey = (key: string) => `vsf-${key}`;\n\ntype Callback<TValue> = (error: Error | null, value?: TValue) => void;\n\nconst mergeLocalStorageItem = (key: string, value: Record<string, unknown>) : void => {\n  const oldValue = window.localStorage.getItem(key);\n  const oldObject = JSON.parse(oldValue);\n  const newObject = value;\n  const nextValue = JSON.stringify({\n    ...JSON.parse(JSON.stringify(oldObject)),\n    ...JSON.parse(JSON.stringify(newObject)),\n  });\n  window.localStorage.setItem(key, nextValue);\n};\n\nconst createPromise = <TValue>(\n  getValue: () => TValue,\n  callback: Callback<TValue>,\n) : Promise<TValue> => new Promise((resolve, reject) => {\n  try {\n    const value = getValue();\n    if (callback) {\n      callback(null, value);\n    }\n    resolve(value);\n  } catch (err) {\n    if (callback) {\n      callback(err as Error);\n    }\n    reject(err);\n  }\n});\n\nexport const getItem = <T = unknown>(\n  key: string,\n  callback?: Callback<T>,\n): Promise<T> => createPromise(() => JSON.parse(window.localStorage.getItem(getVsfKey(key))), callback);\n\nexport const setItem = <T = unknown>(\n  key: string,\n  value: T,\n  callback?: Callback<void>,\n): Promise<void> => createPromise(() => (window.localStorage.setItem(getVsfKey(key), JSON.stringify(value))), callback);\n\nexport const removeItem = (\n  key: string,\n  callback?: Callback<void>,\n): Promise<void> => createPromise(() => {\n  window.localStorage.removeItem(getVsfKey(key));\n}, callback);\n\nexport const mergeItem = (\n  key: string,\n  value: Record<string, unknown>,\n  callback?: Callback<void>,\n): Promise<void> => createPromise(() => mergeLocalStorageItem(getVsfKey(key), value), callback);\n\nexport const clear = (callback?: Callback<void>): Promise<void> => createPromise(() => {\n  window.localStorage.clear();\n}, callback);\n","import { AvailableShippingMethod } from '~/modules/GraphQL/types';\n\nexport default (shippingMethod: AvailableShippingMethod) => {\n  const value = shippingMethod?.amount?.value;\n  const priceWithTax = shippingMethod?.price_incl_tax?.value;\n\n  return priceWithTax > 0 && priceWithTax > value ? priceWithTax : value;\n};\n","import { getItem } from '~/helpers/asyncLocalStorage';\n\nexport const isPreviousStepValid = async (stepToValidate: string) => {\n  const checkout = await getItem('checkout');\n  return !(!checkout || !checkout[stepToValidate]);\n};\n","export * from \"-!../../../../node_modules/extract-css-chunks-webpack-plugin/dist/loader.js??ref--7-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../../../../node_modules/sass-loader/dist/cjs.js??ref--7-oneOf-1-3!../../../../node_modules/sass-resources-loader/lib/loader.js??ref--7-oneOf-1-4!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../../node_modules/unplugin/dist/webpack/loaders/transform.js??ref--15-0!./Payment.vue?vue&type=style&index=0&id=3526570a&prod&lang=scss&scoped=true&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('SfHeading',{staticClass:\"sf-heading--left sf-heading--no-underline title\",attrs:{\"level\":3,\"title\":_vm.$t('Payment')}}),_vm._v(\" \"),_c('SfTable',{staticClass:\"sf-table--bordered table desktop-only\"},[_c('SfTableHeading',{staticClass:\"table__row\"},[_c('SfTableHeader',{staticClass:\"table__header table__image\"},[_vm._v(\"\\n        \"+_vm._s(_vm.$t('Item'))+\"\\n      \")]),_vm._v(\" \"),_vm._l((_vm.tableHeaders),function(tableHeader){return _c('SfTableHeader',{key:tableHeader,staticClass:\"table__header\",class:{ table__description: tableHeader === 'Description' }},[_vm._v(\"\\n        \"+_vm._s(_vm.$t(tableHeader))+\"\\n      \")])})],2),_vm._v(\" \"),_vm._l((_vm.products),function(product,index){return _c('SfTableRow',{key:index,staticClass:\"table__row\"},[_c('SfTableData',{staticClass:\"table__image\"},[_c('SfImage',{attrs:{\"image-tag\":\"nuxt-img\",\"src\":_vm.getMagentoImage(_vm.cartGetters.getItemImage(product)),\"alt\":_vm.cartGetters.getItemName(product),\"width\":_vm.imageSizes.checkout.imageWidth,\"height\":_vm.imageSizes.checkout.imageHeight,\"nuxt-img-config\":{\n            fit: 'cover',\n          }}})],1),_vm._v(\" \"),_c('SfTableData',{staticClass:\"table__data table__description table__data\"},[_c('div',{staticClass:\"product-title\"},[_vm._v(\"\\n          \"+_vm._s(_vm.cartGetters.getItemName(product))+\"\\n        \")]),_vm._v(\" \"),_c('div',{staticClass:\"product-sku\"},[_vm._v(\"\\n          \"+_vm._s(_vm.cartGetters.getItemSku(product))+\"\\n        \")]),_vm._v(\" \"),(_vm.getAttributes(product).length > 0)?_vm._l((_vm.getAttributes(product)),function(attr){return _c('p',{key:attr.option_label,staticClass:\"detail-information\"},[_c('strong',[_vm._v(_vm._s(((attr.option_label) + \":\")))]),_vm._v(_vm._s((\"\" + (attr.value_label)))+\"\\n          \")])}):_vm._e(),_vm._v(\" \"),(_vm.getBundles(product).length > 0)?_vm._l((_vm.getBundles(product)),function(bundle){return _c('p',{key:bundle.label,staticClass:\"detail-information\"},[_vm._v(\"\\n            \"+_vm._s(((bundle.quantity) + \"x \" + (bundle.label)))+\"\\n          \")])}):_vm._e()],2),_vm._v(\" \"),_c('SfTableData',{staticClass:\"table__data\"},[_vm._v(\"\\n        \"+_vm._s(_vm.cartGetters.getItemQty(product))+\"\\n      \")]),_vm._v(\" \"),_c('SfTableData',{staticClass:\"table__data price\"},[_c('SfPrice',{staticClass:\"product-price\",attrs:{\"regular\":_vm.$fc(_vm.cartGetters.getItemPrice(product).regular),\"special\":_vm.cartGetters.getItemPrice(product).special && _vm.$fc(_vm.getRowTotal(product))}})],1)],1)})],2),_vm._v(\" \"),_c('div',{staticClass:\"summary\"},[_c('div',{staticClass:\"summary__group\"},[_c('div',{staticClass:\"summary__total\"},[_c('SfProperty',{staticClass:\"sf-property--full-width property\",attrs:{\"name\":_vm.$t('Subtotal'),\"value\":_vm.$fc(_vm.totals.subtotal)}}),_vm._v(\" \"),(_vm.hasDiscounts)?_c('SfProperty',{staticClass:\"sf-property--full-width sf-property--small property\",attrs:{\"name\":_vm.$t('Discount'),\"value\":_vm.$fc(_vm.discountsAmount)}}):_vm._e()],1),_vm._v(\" \"),(_vm.selectedShippingMethod)?_c('div',{staticClass:\"summary__total\"},[_c('SfProperty',{staticClass:\"sf-property--full-width property\",attrs:{\"value\":_vm.$fc(_vm.getShippingMethodPrice(_vm.selectedShippingMethod))},scopedSlots:_vm._u([{key:\"name\",fn:function(){return [_c('span',{staticClass:\"sf-property__name\"},[_vm._v(\"\\n              \"+_vm._s(_vm.selectedShippingMethod.carrier_title)+\" (\"),_c('small',[_vm._v(_vm._s(_vm.selectedShippingMethod.method_title))]),_vm._v(\")\\n            \")])]},proxy:true}],null,false,323593557)})],1):_vm._e(),_vm._v(\" \"),_c('SfDivider'),_vm._v(\" \"),_c('SfProperty',{staticClass:\"sf-property--full-width sf-property--large summary__property-total\",attrs:{\"name\":_vm.$t('Total price'),\"value\":_vm.$fc(_vm.totals.total)}}),_vm._v(\" \"),_c('VsfPaymentProvider',{on:{\"status\":function($event){_vm.isPaymentReady = true}}}),_vm._v(\" \"),_c('SfCheckbox',{directives:[{name:\"e2e\",rawName:\"v-e2e\",value:('terms'),expression:\"'terms'\"}],staticClass:\"summary__terms\",attrs:{\"name\":\"terms\"},scopedSlots:_vm._u([{key:\"label\",fn:function(){return [_c('div',{staticClass:\"sf-checkbox__label\"},[_vm._v(\"\\n            \"+_vm._s(_vm.$t('I agree to'))+\"\\n            \"),_c('SfLink',{attrs:{\"link\":\"#\"}},[_vm._v(\"\\n              \"+_vm._s(_vm.$t('Terms and conditions'))+\"\\n            \")])],1)]},proxy:true}]),model:{value:(_vm.terms),callback:function ($$v) {_vm.terms=$$v},expression:\"terms\"}}),_vm._v(\" \"),_c('div',{staticClass:\"summary__action\"},[_c('SfButton',{staticClass:\"sf-button color-secondary summary__back-button\",attrs:{\"type\":\"button\"},on:{\"click\":function($event){_vm.$router.push((\"\" + (_vm.localePath('/checkout/billing'))))}}},[_vm._v(\"\\n          \"+_vm._s(_vm.$t('Go back'))+\"\\n        \")]),_vm._v(\" \"),_c('SfButton',{directives:[{name:\"e2e\",rawName:\"v-e2e\",value:('make-an-order'),expression:\"'make-an-order'\"}],staticClass:\"summary__action-button\",attrs:{\"disabled\":_vm.loading || !_vm.isPaymentReady || !_vm.terms},on:{\"click\":_vm.processOrder}},[_vm._v(\"\\n          \"+_vm._s(_vm.$t('Make an order'))+\"\\n        \")])],1)],1)])],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport {\n  SfHeading,\n  SfTable,\n  SfCheckbox,\n  SfButton,\n  SfDivider,\n  SfPrice,\n  SfProperty,\n  SfLink,\n  SfImage,\n} from '@storefront-ui/vue';\nimport {\n  ref,\n  computed,\n  defineComponent,\n  useRouter,\n  useContext,\n  onMounted,\n} from '@nuxtjs/composition-api';\n\nimport cartGetters from '~/modules/checkout/getters/cartGetters';\nimport { useImage } from '~/composables';\nimport useMakeOrder from '~/modules/checkout/composables/useMakeOrder';\nimport useCart from '~/modules/checkout/composables/useCart';\nimport getShippingMethodPrice from '~/helpers/checkout/getShippingMethodPrice';\nimport { removeItem } from '~/helpers/asyncLocalStorage';\nimport { isPreviousStepValid } from '~/helpers/checkout/steps';\nimport type { BundleCartItem, ConfigurableCartItem, CartItemInterface } from '~/modules/GraphQL/types';\n\nexport default defineComponent({\n  name: 'ReviewOrderAndPayment',\n  components: {\n    SfHeading,\n    SfTable,\n    SfCheckbox,\n    SfButton,\n    SfDivider,\n    SfPrice,\n    SfProperty,\n    SfLink,\n    SfImage,\n    VsfPaymentProvider: () => import('~/modules/checkout/components/VsfPaymentProvider.vue'),\n  },\n  setup() {\n    const order = ref(null);\n    const { cart, load, setCart } = useCart();\n    const { make, loading } = useMakeOrder();\n    const { app } = useContext();\n    const router = useRouter();\n    const isPaymentReady = ref(false);\n    const terms = ref(false);\n    const getAttributes = (product: ConfigurableCartItem) => product.configurable_options || [];\n    const getBundles = (product: BundleCartItem) => product.bundle_options?.map((b) => b.values).flat() || [];\n\n    onMounted(async () => {\n      const validStep = await isPreviousStepValid('billing');\n      if (!validStep) {\n        await router.push(app.localePath('/checkout/user-account'));\n      }\n\n      await load();\n    });\n\n    const processOrder = async () => {\n      order.value = await make();\n      setCart(null);\n      app.$vsf.$magento.config.state.removeCartId();\n      await load();\n      await removeItem('checkout');\n      const thankYouRoute = app.localeRoute({\n        name: 'thank-you',\n        query: {\n          order: order.value.order.order_number,\n        },\n      });\n      await router.push(thankYouRoute);\n    };\n\n    const discounts = computed(() => cartGetters.getDiscounts(cart.value));\n    const hasDiscounts = computed(() => discounts.value.length > 0);\n    const discountsAmount = computed(\n      () => -1 * discounts.value.reduce((a, el) => el.value + a, 0),\n    );\n\n    const { getMagentoImage, imageSizes } = useImage();\n    const getRowTotal = (product: CartItemInterface) => cartGetters.getItemPrice(product).regular - cartGetters.getItemPrice(product).special;\n    return {\n      cart,\n      cartGetters,\n      discounts,\n      hasDiscounts,\n      discountsAmount,\n      getShippingMethodPrice,\n      isPaymentReady,\n      loading,\n      processOrder,\n      products: computed(() => cartGetters.getItems(cart.value)),\n      selectedShippingMethod: computed(() => cartGetters.getSelectedShippingMethod(cart.value)),\n      tableHeaders: ['Description', 'Quantity', 'Amount'],\n      terms,\n      totals: computed(() => cartGetters.getTotals(cart.value)),\n      getAttributes,\n      getBundles,\n      getMagentoImage,\n      imageSizes,\n      getRowTotal,\n    };\n  },\n});\n","import mod from \"-!../../../../node_modules/babel-loader/lib/index.js??ref--13-0!../../../../node_modules/ts-loader/index.js??ref--13-1!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../../node_modules/unplugin/dist/webpack/loaders/transform.js??ref--15-0!./Payment.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../node_modules/babel-loader/lib/index.js??ref--13-0!../../../../node_modules/ts-loader/index.js??ref--13-1!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../../node_modules/unplugin/dist/webpack/loaders/transform.js??ref--15-0!./Payment.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./Payment.vue?vue&type=template&id=3526570a&scoped=true&\"\nimport script from \"./Payment.vue?vue&type=script&lang=ts&\"\nexport * from \"./Payment.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./Payment.vue?vue&type=style&index=0&id=3526570a&prod&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"3526570a\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}